# 工小聊 PC 端产品需求文档

## 1. 产品定位
工小聊定位为工厂端跨平台即时通讯与工单协同管理工具，致力于用微信式的使用体验串联从原料采购、生产工序、品质追溯到出货对账的全流程，帮助小微工厂实现一人即可维护的自动化协同。

## 2. 用户角色
- **老板 / 管理员**：负责账号体系、工序模板配置、工单创建及全局监控。
- **工人**：聚焦在个人工序的执行、反馈和闪电工单的快速处理。
- **采购工厂联系人（可选）**：接收自动推送的补料 / 返工需求。

## 3. 使用场景与核心流程
1. 登录与权限加载 → 微信风格主界面 → 查看工单卡片 → 进入工单聊天 → 完成/异常反馈 → 数据沉淀与导出。
2. 实现 PC 与 Android 端数据互通，PC 端优先落地，Android 端沿用同一服务端能力。

## 4. 核心功能
### 4.1 登录与权限
- 支持账号密码登录，后续可扩展扫码登录。
- 登录后拉取角色、工序及工单权限。

### 4.2 主界面
- 微信风格配色，左侧为工单列表，右侧为聊天区，顶部提供全局检索与工单筛选。
- 工单列表按照状态（进行中 / 待处理 / 已完成 / 已废除）分组展示，可折叠。
- 右上角快捷入口：创建工单、闪电工单、工序模板管理、数据导出。

### 4.3 工单管理
- **创建工单**：支持配置标题、起止时间、数量要求、负责人、工序流程、质量检出策略、指定采购工厂等。
- **工单编辑/删除/设置**：右键菜单操作，设置项包括不合格品自动推送策略。
- **工序定义**：老板可以在后台预设工序模板，并在创建工单时快速套用，支持拖拽排序。
- **工单导出**：导出包含工序进度、完成数量、品质数据的 Excel / PDF。

### 4.4 聊天与协同
- 进入工单即打开聊天会话，支持文本、表情、图片、拍照、附件上传。
- 上传图纸 / 品质文件后自动触发 OCR → 数据解析 → 标准化 Excel → 聊天内推送可预览/下载的表格。
- 聊天侧栏展示工单关键信息（负责人、当前工序、剩余数量、品质异常记录等）。

### 4.5 工序执行
- 工人右下角“完成工序”按钮 → 浮层输入完成数量、不合格数量 → 系统依据工单需求实时扣减。
- 若存在不合格数量，根据工单设置自动触发采购工厂通知，内容包括零件类型、缺口数量、预计补料时间。
- 支持工序负责人填写预计完成时间，展示在工单卡片。

### 4.6 闪电工单
- 任一工人可发起，需选择归属（某一工单或独立）。
- 仅填写备注与完成数量，快速记录突发需求。
- 闪电工单可单独导出，也可和父工单一起汇总。

### 4.7 数据中心
- 老板拥有卡片式看板，按状态展示工单，支持快速过滤（工厂、工序、负责人等）。
- 每张卡片显示：工单标题、负责人、当前工序、剩余量、预计完成时间、品质异常提示。
- 支持对账单、送货单一键生成与打印。

### 4.8 订阅与授权
- 采用云端发码的授权模型，老板可在 PC 端输入激活码开通/升级套餐。
- 支持封停、恢复与续期，封停期间保留数据但禁止新终端登录。
- 套餐分为三档：云启版、智控版、旗舰版，覆盖从 15 人以内工厂到跨厂区集团的需求。
- 套餐需展示价格、适用场景、授权席位、OCR 额度与核心功能差异，方便老板评估。

## 5. 非功能需求
- UI 颜色参照微信：暗绿色主色（#1AAD19）、浅色背景（#F5F5F5）、灰度文案色。
- PC 端首期采用 Electron + React + TypeScript + TailwindCSS 技术栈，保证多端一致性。
- 后端采用 NestJS + PostgreSQL + Redis，提供 REST + WebSocket 服务。
- OCR 服务使用 Python 微服务（FastAPI）对接第三方 OCR（如腾讯云），解析后回写数据中心。
- 安全：所有接口需鉴权，聊天与附件上传使用 HTTPS，敏感数据加密存储。

## 6. 里程碑
1. **M1 - 可用 MVP（4 周）**
   - 完成账号体系、工单创建与聊天基础能力。
   - 提供工人完工反馈、闪电工单初版。
2. **M2 - 自动化闭环（8 周）**
   - 接入 OCR，完善品质数据表格化与自动推送采购。
   - 打通对账单 / 送货单自动生成。
3. **M3 - 深度优化（12 周）**
   - 引入进度预测、异常预警、Android 端发布。

## 7. 风险与对策
- **OCR 识别准确率**：前期限制模板类型，允许人工校正。
- **跨端数据一致性**：统一 WebSocket 通道与状态同步机制。
- **权限复杂度**：以角色 + 细粒度工序权限组合，提供可视化配置工具。

